# Base
- type: entity
  abstract: true
  id: MobIncorporealBase
  name: incorporeal entity
  description: You can't touch it, but it can touch you.
  components:
  - type: FootstepModifier
    footstepSoundCollection:
      path: /Audio/_NF/Effects/silence.ogg
  - type: CanMoveInAir
  - type: Fixtures
    fixtures:
      fix1:
        shape:
          !type:PhysShapeCircle
          radius: 0.4
        density: 10
        mask:
        - FlyingMobMask
        layer:
        - Opaque

# Possessed Toilet
- type: entity
  id: MobMemeGoblinbane
  name: goblinbane
  parent: [ MobNonHumanHostileBase, MobHumanoidHostileAIComplex ]
  description: Daemon of Cleanliness. Anathema for goblinkind.
  #categories: [ HideSpawnMenu ]
  components:
  - type: NpcFactionMember
    factions:
    - GoblinbaneFaction
  - type: CanMoveInAir
  - type: Fixtures
    fixtures:
      fix1:
        shape:
          !type:PhysShapeCircle
          radius: 0.40
        density: 100
        mask:
          - FlyingMobMask
        layer:
          - FlyingMobLayer
  - type: Sprite
    drawdepth: Mobs
    sprite: _NF/Mobs/Meme/goblinbane.rsi
    layers:
    - map: [ "enum.DamageStateVisualLayers.Base" ]
      state: alive
    - map: [ "enum.DamageStateVisualLayers.BaseUnshaded" ]
      state: alive_unshaded
      shader: unshaded
  - type: DamageStateVisuals
    states:
      Alive:
        Base: alive
        BaseUnshaded: alive_unshaded
      Dead:
        Base: dead
        BaseUnshaded: dead_unshaded
  - type: MobThresholds
    thresholds:
      0: Alive
      200: Dead
  - type: Stamina
    critThreshold: 400
  - type: Destructible
    thresholds:
    - trigger:
        !type:DamageTrigger
        damage: 200
      behaviors:
      - !type:PlaySoundBehavior
        sound:
          collection: GlassBreak
      - !type:SpawnEntitiesBehavior
        spawn:
          MobMemeGoblinbaneGhost:
            min: 1
            max: 1
      - !type:DoActsBehavior
        acts: [ "Destruction" ]
  - type: MeleeWeapon
    soundHit:
      path: /Audio/Effects/bite.ogg
    damage:
      types:
        Slash: 15
        Structural: 20
    animation: WeaponArcBite
  - type: PointLight
    radius: 1.4
    energy: 1.2
    color: "#ff0000"

- type: entity
  id: MobMemeGoblinbaneGhost
  parent: [ MobIncorporealBase, MobMemeGoblinbane ]
  suffix: Ghost form
  #categories: [ HideSpawnMenu ]
  components:
  - type: Sprite
    drawdepth: Mobs
    sprite: _NF/Mobs/Meme/goblinbane.rsi
    layers:
    - map: [ "enum.DamageStateVisualLayers.Base" ]
      state: ghost
    - map: [ "enum.DamageStateVisualLayers.BaseUnshaded" ]
      state: ghost_unshaded
      shader: unshaded
  - type: DamageStateVisuals
    states:
      Alive:
        Base: ghost
        BaseUnshaded: ghost_unshaded
      Dead:
        Base: dead
        BaseUnshaded: dead_unshaded
  - type: MobThresholds
    thresholds:
      0: Alive
      200: Dead
  - type: Destructible
    thresholds:
    - trigger:
        !type:DamageTrigger
        damage: 200
      behaviors:
      - !type:PlaySoundBehavior
        sound:
          collection: GlassBreak
      - !type:SpawnEntitiesBehavior
        spawn:
          MobMemePossessedMop:
            min: 1
            max: 2
          MobMemePossessedSpray:
            min: 2
            max: 2
      - !type:DoActsBehavior
        acts: [ "Destruction" ]

# Possessed Mop
- type: entity
  id: MobMemePossessedMop
  name: possessed mop
  parent: MobMemeGoblinbane
  #categories: [ HideSpawnMenu ]
  components:
  - type: Sprite
    drawdepth: Mobs
    sprite: _NF/Mobs/Meme/goblinbane.rsi
    layers:
    - map: [ "enum.DamageStateVisualLayers.Base" ]
      state: mop_alive
    - map: [ "enum.DamageStateVisualLayers.BaseUnshaded" ]
      state: mop_unshaded
      shader: unshaded
  - type: DamageStateVisuals
    states:
      Alive:
        Base: mop_alive
        BaseUnshaded: ghost_unshaded
      Dead:
        Base: mop_dead
        BaseUnshaded: mop_dead_unshaded
  - type: MobThresholds
    thresholds:
      0: Alive
      50: Dead
  - type: Destructible
    thresholds:
    - trigger:
        !type:DamageTrigger
        damage: 50
      behaviors:
      - !type:PlaySoundBehavior
        sound:
          collection: GlassBreak
      - !type:SpawnEntitiesBehavior
        spawn:
          AdvMopItem:
            min: 1
            max: 1
      - !type:DoActsBehavior
        acts: [ "Destruction" ]

# Possessed Spray
- type: entity
  id: MobMemePossessedSpray
  name: possessed spray
  parent: MobMemeGoblinbane
  #categories: [ HideSpawnMenu ]
  components:
  - type: Sprite
    drawdepth: Mobs
    sprite: _NF/Mobs/Meme/goblinbane.rsi
    layers:
    - map: [ "enum.DamageStateVisualLayers.Base" ]
      state: spray_alive
    - map: [ "enum.DamageStateVisualLayers.BaseUnshaded" ]
      state: spray_unshaded
      shader: unshaded
  - type: DamageStateVisuals
    states:
      Alive:
        Base: spray_alive
        BaseUnshaded: ghost_unshaded
      Dead:
        Base: spray_dead
        BaseUnshaded: spray_dead_unshaded
  - type: MobThresholds
    thresholds:
      0: Alive
      50: Dead
  - type: Destructible
    thresholds:
    - trigger:
        !type:DamageTrigger
        damage: 50
      behaviors:
      - !type:PlaySoundBehavior
        sound:
          collection: GlassBreak
      - !type:SpawnEntitiesBehavior
        spawn:
          SprayBottleSpaceCleaner:
            min: 1
            max: 1
      - !type:DoActsBehavior
        acts: [ "Destruction" ]

# Possessed Bucket
- type: entity
  id: MobMemePossessedBucket
  name: possessed mop bucket
  parent: MobMemeGoblinbane
  #categories: [ HideSpawnMenu ]
  components:
  - type: Sprite
    drawdepth: Mobs
    sprite: _NF/Mobs/Meme/goblinbane.rsi
    layers:
    - map: [ "enum.DamageStateVisualLayers.Base" ]
      state: bucket_alive
    - map: [ "enum.DamageStateVisualLayers.BaseUnshaded" ]
      state: bucket_unshaded
      shader: unshaded
  - type: DamageStateVisuals
    states:
      Alive:
        Base: bucket_alive
        BaseUnshaded: bucket_unshaded
      Dead:
        Base: bucket_dead
        BaseUnshaded: ""
  - type: MobThresholds
    thresholds:
      0: Alive
      50: Dead
  - type: Destructible
    thresholds:
    - trigger:
        !type:DamageTrigger
        damage: 50
      behaviors:
      - !type:PlaySoundBehavior
        sound:
          collection: GlassBreak
      - !type:SpawnEntitiesBehavior
        spawn:
          MopBucket:
            min: 1
            max: 1
          SoapNT:
            min: 1
            max: 1
      - !type:DoActsBehavior
        acts: [ "Destruction" ]
    hidden: true
    soundHit:
      collection: MetalThud
    damage:
      groups:
        Brute: 8
